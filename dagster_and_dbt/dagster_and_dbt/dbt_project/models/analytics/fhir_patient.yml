version: 2

models:
  - name: fhir_patient
    description: >
      Final patient model built from the cleaned staging layer.
      Includes a generated ID, normalized fields, and contact information in JSONB format.
    columns:
      - name: id
        description: Unique identifier generated as a hash of key patient attributes.
        tests:
          - not_null
          - unique

      - name: full_name
        description: Full name of the patient.

      - name: birth_date
        description: Patient's birth date.

      - name: gender
        description: Normalized gender (Male, Female, Non-Binary, Unknown).

      - name: address
        description: Street address.

      - name: telecom
        description: JSONB object containing phone and email information.

      - name: marital_status
        description: Patient's marital status.

      - name: insurance_number
        description: Unique insurance number for each patient.
        tests:
          - not_null
          - unique

      - name: nationality
        description: Truncated nationality (max 20 characters).